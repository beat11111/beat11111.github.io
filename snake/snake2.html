<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>方块</title>
	<style type="text/css">
		#ta {
			float:left;
			
		}

		td {
			width: 20px;
			height:18px;
			background-color: green;
			border-radius: 100%;
		}

		#case {		
			width: 408px;
			height: 410px;
		}

		.foods{
			background-color: red;
		}

		.snakeBody {
			background-color: yellow;
		}
		.myButton {
			border-radius:100%;
			border-style: 0px solid black;
			width: 100px;
			height:50px;
			background-color: green;
			text-align: center;
			line-height: 50px;
			font-size: 20px;
			color: yellow;
		}

		#button1 {
			position: absolute;
			top: 395px;
			left:310px;
		}

		#button2 {
			position: absolute;
			top: 400px;
			left:110px;
		}

		#button3 {
			position: absolute;
			top: 450px;
			left:210px;
		}

		#button4 {
			position: absolute;
			top: 500px;
			left:110px;
		}
		#button5 {
			position: absolute;
			top: 450px;
			left:10px;
		}
		#button6 {
			position: absolute;
			top: 505px;
			left:310px;
		}
		#button7 {
			position: absolute;
			top: 450px;
			left:310px;
		}
		.snakeHead {
			border-radius : 100%;
			background-color: black;
		}
	</style>
</head>
<body>
	<div id = "case">
		<table id = "ta">
		<tr>
			<td id = "1"></td>
			<td id = "2"></td>
			<td id = "3"></td>
			<td id = "4"></td>
			<td id = "5"></td>
			<td id = "6"></td>
			<td id = "7"></td>
			<td id = "8"></td>
			<td id = "9"></td>
			<td id = "10"></td>
			<td id = "11"></td>
			<td id = "12"></td>
			<td id = "13"></td>
			<td id = "14"></td>
			<td id = "15"></td>
			<td id = "16"></td>
			<td id = "17"></td>
			<td id = "18"></td>
			<td id = "19"></td>
			<td id = "20"></td>
		</tr>
		<tr>
			<td id = "21"></td>
			<td id = "22"></td>
			<td id = "23"></td>
			<td id = "24"></td>
			<td id = "25"></td>
			<td id = "26"></td>
			<td id = "27"></td>
			<td id = "28"></td>
			<td id = "29"></td>
			<td id = "30"></td>
			<td id = "31"></td>
			<td id = "32"></td>
			<td id = "33"></td>
			<td id = "34"></td>
			<td id = "35"></td>
			<td id = "36"></td>
			<td id = "37"></td>
			<td id = "38"></td>
			<td id = "39"></td>
			<td id = "40"></td>
		</tr>
		<tr>
			<td id = "41"></td>
			<td id = "42"></td>
			<td id = "43"></td>
			<td id = "44"></td>
			<td id = "45"></td>
			<td id = "46"></td>
			<td id = "47"></td>
			<td id = "48"></td>
			<td id = "49"></td>
			<td id = "50"></td>
			<td id = "51"></td>
			<td id = "52"></td>
			<td id = "53"></td>
			<td id = "54"></td>
			<td id = "55"></td>
			<td id = "56"></td>
			<td id = "57"></td>
			<td id = "58"></td>
			<td id = "59"></td>
			<td id = "60"></td>
		</tr>
		<tr>
			<td id = "61"></td>
			<td id = "62"></td>
			<td id = "63"></td>
			<td id = "64"></td>
			<td id = "65"></td>
			<td id = "66"></td>
			<td id = "67"></td>
			<td id = "68"></td>
			<td id = "69"></td>
			<td id = "70"></td>
			<td id = "71"></td>
			<td id = "72"></td>
			<td id = "73"></td>
			<td id = "74"></td>
			<td id = "75"></td>
			<td id = "76"></td>
			<td id = "77"></td>
			<td id = "78"></td>
			<td id = "79"></td>
			<td id = "80"></td>
		</tr>
		<tr>
			<td id = "81"></td>
			<td id = "82"></td>
			<td id = "83"></td>
			<td id = "84"></td>
			<td id = "85"></td>
			<td id = "86"></td>
			<td id = "87"></td>
			<td id = "88"></td>
			<td id = "89"></td>
			<td id = "90"></td>
			<td id = "91"></td>
			<td id = "92"></td>
			<td id = "93"></td>
			<td id = "94"></td>
			<td id = "95"></td>
			<td id = "96"></td>
			<td id = "97"></td>
			<td id = "98"></td>
			<td id = "99"></td>
			<td id = "100"></td>
		</tr>
		<tr>
			<td id = "102"></td>
			<td id = "102"></td>
			<td id = "103"></td>
			<td id = "104"></td>
			<td id = "105"></td>
			<td id = "106"></td>
			<td id = "107"></td>
			<td id = "108"></td>
			<td id = "109"></td>
			<td id = "110"></td>
			<td id = "111"></td>
			<td id = "112"></td>
			<td id = "113"></td>
			<td id = "114"></td>
			<td id = "115"></td>
			<td id = "116"></td>
			<td id = "117"></td>
			<td id = "118"></td>
			<td id = "119"></td>
			<td id = "120"></td>
		</tr>
		<tr>
			<td id = "121"></td>
			<td id = "122"></td>
			<td id = "123"></td>
			<td id = "124"></td>
			<td id = "125"></td>
			<td id = "126"></td>
			<td id = "127"></td>
			<td id = "128"></td>
			<td id = "129"></td>
			<td id = "130"></td>
			<td id = "131"></td>
			<td id = "132"></td>
			<td id = "133"></td>
			<td id = "134"></td>
			<td id = "135"></td>
			<td id = "136"></td>
			<td id = "137"></td>
			<td id = "138"></td>
			<td id = "139"></td>
			<td id = "140"></td>
		</tr>
		<tr>
			<td id = "141"></td>
			<td id = "142"></td>
			<td id = "143"></td>
			<td id = "144"></td>
			<td id = "145"></td>
			<td id = "146"></td>
			<td id = "147"></td>
			<td id = "148"></td>
			<td id = "149"></td>
			<td id = "150"></td>
			<td id = "151"></td>
			<td id = "152"></td>
			<td id = "153"></td>
			<td id = "154"></td>
			<td id = "155"></td>
			<td id = "156"></td>
			<td id = "157"></td>
			<td id = "158"></td>
			<td id = "159"></td>
			<td id = "160"></td>
		</tr>
		<tr>
			<td id = "161"></td>
			<td id = "162"></td>
			<td id = "163"></td>
			<td id = "164"></td>
			<td id = "165"></td>
			<td id = "166"></td>
			<td id = "167"></td>
			<td id = "168"></td>
			<td id = "169"></td>
			<td id = "170"></td>
			<td id = "171"></td>
			<td id = "172"></td>
			<td id = "173"></td>
			<td id = "174"></td>
			<td id = "175"></td>
			<td id = "176"></td>
			<td id = "177"></td>
			<td id = "178"></td>
			<td id = "179"></td>
			<td id = "180"></td>
		</tr>
		<tr>
			<td id = "181"></td>
			<td id = "182"></td>
			<td id = "183"></td>
			<td id = "184"></td>
			<td id = "185"></td>
			<td id = "186"></td>
			<td id = "187"></td>
			<td id = "188"></td>
			<td id = "189"></td>
			<td id = "190"></td>
			<td id = "191"></td>
			<td id = "192"></td>
			<td id = "193"></td>
			<td id = "194"></td>
			<td id = "195"></td>
			<td id = "196"></td>
			<td id = "197"></td>
			<td id = "198"></td>
			<td id = "199"></td>
			<td id = "200"></td>
		</tr>
		<tr>
			<td id = "201"></td>
			<td id = "202"></td>
			<td id = "203"></td>
			<td id = "204"></td>
			<td id = "205"></td>
			<td id = "206"></td>
			<td id = "207"></td>
			<td id = "208"></td>
			<td id = "209"></td>
			<td id = "210"></td>
			<td id = "211"></td>
			<td id = "212"></td>
			<td id = "213"></td>
			<td id = "214"></td>
			<td id = "215"></td>
			<td id = "216"></td>
			<td id = "217"></td>
			<td id = "218"></td>
			<td id = "219"></td>
			<td id = "220"></td>
		</tr>
		<tr>
			<td id = "221"></td>
			<td id = "222"></td>
			<td id = "223"></td>
			<td id = "224"></td>
			<td id = "225"></td>
			<td id = "226"></td>
			<td id = "227"></td>
			<td id = "228"></td>
			<td id = "229"></td>
			<td id = "230"></td>
			<td id = "231"></td>
			<td id = "232"></td>
			<td id = "233"></td>
			<td id = "234"></td>
			<td id = "235"></td>
			<td id = "236"></td>
			<td id = "237"></td>
			<td id = "238"></td>
			<td id = "239"></td>
			<td id = "240"></td>
		</tr>
		<tr>
			<td id = "241"></td>
			<td id = "242"></td>
			<td id = "243"></td>
			<td id = "244"></td>
			<td id = "245"></td>
			<td id = "246"></td>
			<td id = "247"></td>
			<td id = "248"></td>
			<td id = "249"></td>
			<td id = "250"></td>
			<td id = "251"></td>
			<td id = "252"></td>
			<td id = "253"></td>
			<td id = "254"></td>
			<td id = "255"></td>
			<td id = "256"></td>
			<td id = "257"></td>
			<td id = "258"></td>
			<td id = "259"></td>
			<td id = "260"></td>
		</tr>
		<tr>
			<td id = "261"></td>
			<td id = "262"></td>
			<td id = "263"></td>
			<td id = "264"></td>
			<td id = "265"></td>
			<td id = "266"></td>
			<td id = "267"></td>
			<td id = "268"></td>
			<td id = "269"></td>
			<td id = "270"></td>
			<td id = "271"></td>
			<td id = "272"></td>
			<td id = "273"></td>
			<td id = "274"></td>
			<td id = "275"></td>
			<td id = "276"></td>
			<td id = "277"></td>
			<td id = "278"></td>
			<td id = "279"></td>
			<td id = "280"></td>
		</tr>
		<tr>
			<td id = "281"></td>
			<td id = "282"></td>
			<td id = "283"></td>
			<td id = "284"></td>
			<td id = "285"></td>
			<td id = "286"></td>
			<td id = "287"></td>
			<td id = "288"></td>
			<td id = "289"></td>
			<td id = "290"></td>
			<td id = "291"></td>
			<td id = "292"></td>
			<td id = "293"></td>
			<td id = "294"></td>
			<td id = "295"></td>
			<td id = "296"></td>
			<td id = "297"></td>
			<td id = "298"></td>
			<td id = "299"></td>
			<td id = "300"></td>
		</tr>
		<tr>
			<td id = "301"></td>
			<td id = "302"></td>
			<td id = "303"></td>
			<td id = "304"></td>
			<td id = "305"></td>
			<td id = "306"></td>
			<td id = "307"></td>
			<td id = "308"></td>
			<td id = "309"></td>
			<td id = "310"></td>
			<td id = "311"></td>
			<td id = "312"></td>
			<td id = "313"></td>
			<td id = "314"></td>
			<td id = "315"></td>
			<td id = "316"></td>
			<td id = "317"></td>
			<td id = "318"></td>
			<td id = "319"></td>
			<td id = "320"></td>
		</tr>
		<tr>
			<td id = "321"></td>
			<td id = "322"></td>
			<td id = "323"></td>
			<td id = "324"></td>
			<td id = "325"></td>
			<td id = "326"></td>
			<td id = "327"></td>
			<td id = "328"></td>
			<td id = "329"></td>
			<td id = "330"></td>
			<td id = "331"></td>
			<td id = "332"></td>
			<td id = "333"></td>
			<td id = "334"></td>
			<td id = "335"></td>
			<td id = "336"></td>
			<td id = "337"></td>
			<td id = "338"></td>
			<td id = "339"></td>
			<td id = "340"></td>
		</tr>
		</table>
	</div>
		<button id = "button1" class = "myButton" >Begin</button>
		<button id = "button2" class = "myButton" >UP</button>
		<button id = "button3" class = "myButton" >RIGHT</button>
		<button id = "button4" class = "myButton" >DOWN</button>
		<button id = "button5" class = "myButton" >LEFT</button>
		<button id = "button6" class = "myButton">Again</button>
		<button id = "button7" class = "myButton">Pause</button>

	<script type="text/javascript">
		//未完成目标，同方向或反方向事件应该不起作用
		var button1 = document.getElementById("button1");
		var button2 = document.getElementById("button2");
		var button3 = document.getElementById("button3");
		var button4 = document.getElementById("button4");
		var button5 = document.getElementById("button5");
		var button6 = document.getElementById("button6");
		var button7 = document.getElementById("button7");

		button1.addEventListener("click", gameBegin);
		button6.addEventListener("click", gameBegin);

		button7.addEventListener("click", pause);

		function pause() {
			if(button7.innerHTML = "Pause"){
			clearInterval(intervalId);
			button7.innerHTML = "Continue";				
			}
		}
		var idX = ["00", "01", "02", "03", "04" ,"05", "06", "07", "08", "09", "10" ,"11", "12", "13", "14", "15", "16", "17", "18", "19"];
		var idY= ["00", "01", "02", "03", "04", "05", "06", "07", "08", "09", "10" ,"11", "12", "13", "14", "15","16"];
		var x,
			y,
			xy;

		var td = document.getElementsByTagName("td");
		var tdId = 0;
		for ( var j = 0; j < 17; j ++){
			for( var i = 0; i < 20; i ++ ){
				td[tdId].id = idX[i] + idY[j];
				//td[tdId].innerHTML = idX[i] + idY[j];
				tdId ++;
			}
		}

		var allTdId = [];
		for(i = 0; i < td.length; i ++)
			allTdId[i] = td[i].id;

		var intervalId;		//蛇移动定时程序
		var speed;	//蛇移动的速度

		function changeSpeed() {
			if(speed < 250){
				return;
			}else{
				speed -= 2;
			}
		}

		function gameBegin() {
			speed = 600;
			for( var i = 0; i < td.length; i ++ )
				td[i].className = "abc";
			x = 10;			//设置初始蛇身坐标
			y = 11;
			xy = [(idX[x] + idY[y-2]), (idX[x] + idY[y-1]),(idX[x] + idY[y])];
			paint();	//画出蛇身
			food();		//初始投放食物
			document.addEventListener("keydown",move);
			button1.innerHTML = "Playing";
			button2.addEventListener("click", snakeButtonUp);
			button3.addEventListener("click", snakeButtonRight);
			button4.addEventListener("click", snakeButtonDown);
			button5.addEventListener("click", snakeButtonLeft);			
			button1.removeEventListener("click", gameBegin);
		}

		function move(e) {
			var keyCode = e.keyCode;
			console.log(keyCode);
			console.log(speed);
			switch(keyCode) {
				case 39: case 68:{			
						button7.innerHTML = "Pause";		
						clearInterval(intervalId);
						intervalId = setInterval(snakeRight, speed);
							
					break;
				}	
				case 37: case 65:{
						button7.innerHTML = "Pause";	
						clearInterval(intervalId);
						intervalId = setInterval(snakeLeft, speed);

					break;
				}
				case 40: case 83:{
						button7.innerHTML = "Pause";	
						clearInterval(intervalId);
						intervalId = setInterval(snakeDown, speed);
					break;
				}
				case 38: case 87:{
						button7.innerHTML = "Pause";	
						clearInterval(intervalId);
						intervalId = setInterval(snakeUp, speed);
					break;
				}
				case 0: case 32:{				
					pause();
					break;
				}				

			}
		}

		function paint() {
			for( var i = 0; i < xy.length; i ++ )
				document.getElementById(xy[i]).className = "snakeBody";
			document.getElementById(xy[xy.length-1]).className = "snakeHead";	
		}


		function clearAllEvent() {
				clearInterval(intervalId);
				document.removeEventListener("keydown",move);
				button2.removeEventListener("click", snakeButtonUp);
				button3.removeEventListener("click", snakeButtonRight);
				button4.removeEventListener("click", snakeButtonDown);
				button5.removeEventListener("click", snakeButtonLeft);		
				button1.innerHTML = "Over";
		}

		function snakeButtonUp() {
			button7.innerHTML = "Pause";	
			clearInterval(intervalId);
			intervalId = setInterval(snakeUp, speed);
		}

		function snakeButtonRight() {
			button7.innerHTML = "Pause";	
			clearInterval(intervalId);
			intervalId = setInterval(snakeRight, speed);
		}

		function snakeButtonDown() {
			button7.innerHTML = "Pause";	
			clearInterval(intervalId);
			intervalId = setInterval(snakeDown, speed);
		}

		function snakeButtonLeft() {
			button7.innerHTML = "Pause";	
			clearInterval(intervalId);
			intervalId = setInterval(snakeLeft, speed);
		}

		var bite;

		function snakeRight() {
			changeSpeed();
			dropFood();
			bite = biteSnake();
			if(x > 18 || bite == true){	
				clearAllEvent();
			}
			xy.push((idX[x++] + idY[y]));
			document.getElementById(xy[0]).className = null;
			xy.shift();
			paint();
		}

		function snakeLeft() {
			changeSpeed();
			dropFood();
			bite = biteSnake();
			if(x < 1 || bite == true){
				clearAllEvent();
			}
			xy.push((idX[x--] + idY[y]));
			document.getElementById(xy[0]).className = null;
			xy.shift();
			paint();
		}
		function snakeDown() {
			changeSpeed();
			dropFood();
			bite = biteSnake();
			if(y > 15 || bite == true){
				clearAllEvent();
			}
			xy.push((idX[x] + idY[y++]));
			document.getElementById(xy[0]).className = null;
			xy.shift();
			paint();
		}
		function snakeUp() {
			changeSpeed();
			dropFood();
			bite = biteSnake();
			if(y < 1 || bite == true){
				clearAllEvent();
			}
			xy.push((idX[x] + idY[y--]));
			document.getElementById(xy[0]).className = null;
			xy.shift();
			paint();
		}

		function biteSnake() {
			for(var i = 0; i < xy.length - 1; i ++){
				if((idX[x] + idY[y]) == xy[i])
					return true;
				}	
				return false;
		}

		var randomFood;		//食物投放坐标点

		function food() {
			var noSnake = allTdId.map(isInTd);	//获得除蛇身之外的所有坐标点
			do{
				randomFood = noSnake[Math.floor(Math.random()*340)];
			}while(!randomFood)
			document.getElementById(randomFood).className = "foods";
		}

		function isInTd(value) {
			var temp = false;
			for(var i = 0; i < xy.length; i ++){
				if(value == xy[i]) {
					return;
				}else{
				continue;
				}
			}
			return value;
		}

		function dropFood() {
			if((idX[x] + idY[y]) == randomFood){
				food();
				xy.unshift(xy[0]);
			}
		}

	</script>
</body>
</html>